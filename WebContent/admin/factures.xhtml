<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets">
	
	
<ui:composition template="../resources/template/layout.xhtml">
	<ui:define name="head">
		<title>Admin . Gestion Factures</title>
		<link rel="stylesheet" href="../resources/bootstrap/css/bootstrap.min.css" />
		<style>
			.b2{
			background-color: #6c757d;
			color: white;
			}
			
	.ui-datatable .ui-datatable-header {
        text-align: right !important;
    }
     
    .ui-selectcheckboxmenu-panel .ui-selectcheckboxmenu-header .ui-chkbox {
        display: none;
    }
		</style>
	</ui:define>

	<ui:define name="body">
	
		<h:form>
	    	<p:growl showDetail="true" life="5000">
	        	<p:autoUpdate />
	    	</p:growl>
		</h:form>
		
		<div class="container-fluid">
			<h2 class="h2 text-center">Gestion Des Factures</h2>
			
			<div class="row">
				<div class="col-md-12">
					<br/>					
					<h:form id="form">
					    <p:dataTable var="comm" value="#{facturesBean.commandes}" sortBy="#{comm.dateAjout.getDay()}" rows="8" 
                 paginator="true" selectionMode="single" selection="#{facturesBean.selectedCommande}" rowKey="#{comm.id}"
                 paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                 rowsPerPageTemplate="8,16,24">
                 	
                 			<p:ajax event="rowSelect" update=":form:commDetail" oncomplete="PF('commDialog').show();" />
                 			
					        <p:column headerText="Id">
					            <h:outputText value="#{comm.id}" />
					        </p:column>
					        <p:column headerText="Nbre Medicaments">
					            <h:outputText value="#{comm.lignesCommande.size()}" />
					        </p:column>
					        <p:column headerText="Date">
					            <h:outputText value="#{comm.dateAjout}" />
					        </p:column>
					        <p:column headerText="Client">
					            <h:outputText value="#{comm.client.nom}" />
					        </p:column>
					        <p:column headerText="Prix" sortBy="#{comm.prixTotal}">
					            <h:outputText value="#{comm.prixTotal}" />
					        </p:column>
					        <p:summaryRow>
					            <p:column colspan="4" style="text-align:right">
					                <h:outputText value="Total:" />
					            </p:column>
					            <p:column>
					                <h:outputText value="#{ facturesBean.getTotalPrice(comm.dateAjout.getDay()) }">
					                    <f:convertNumber type="currency" currencySymbol="MAD" />
					                </h:outputText>
					            </p:column>
					        </p:summaryRow>
					    </p:dataTable>
					    
					    
					    <p:dialog header="Commande Info" widgetVar="commDialog" modal="false" showEffect="fade" hideEffect="fade" resizable="false">
					        <p:outputPanel id="commDetail" style="text-align:center;">
					            <p:panelGrid  columns="2" rendered="#{not empty facturesBean.selectedCommande}" columnClasses="label,value">
					                <f:facet name="header">
					                    <p:outputLabel value="Commande SelectionnÃ©e"></p:outputLabel> 
					                </f:facet>
					                 
					                <h:outputText value="Id:" />
					                <h:outputText value="#{facturesBean.selectedCommande.id}" />
					 
					                <h:outputText value="Nom" />
					                <h:outputText value="#{facturesBean.selectedCommande.client.nom}" />
					                 
					                <h:outputText value="Prenom" />
					                <h:outputText value="#{facturesBean.selectedCommande.client.prenom}" />
					 
					                <h:outputText value="Prix :" />
					                <h:outputText value="#{facturesBean.selectedCommande.prixTotal}"/>
					            </p:panelGrid>
					        </p:outputPanel>
					    </p:dialog>
					    
					    
					</h:form>
					
				</div>
			</div>
		</div>
	
	<script src="../resources/bootstrap/js/bootstrap.min.js"></script>
	</ui:define>


</ui:composition>

</html>